<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Login</title>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        // Configuraci√≥n de Firebase (reemplaza con tu configuraci√≥n)
        const firebaseConfig = {
            apiKey: "AIzaSyAkhNt7OGINJdEeEHU5iNEPbdWbxbul_IU",
  authDomain: "concreteware.firebaseapp.com",
  databaseURL: "https://concreteware-default-rtdb.firebaseio.com",
  projectId: "concreteware",
  storageBucket: "concreteware.firebasestorage.app",
  messagingSenderId: "968538787293",
  appId: "1:968538787293:web:afe035a4726c410e2efa34",
  measurementId: "G-F00R0SQ8Y5"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        window.testLogin = async () => {
            try {
                console.log('üîê Iniciando login con Firebase...');
                
                // Login con Firebase
                const userCredential = await signInWithEmailAndPassword(auth, 'juan@ejemplo.com', 'secreto123');
                console.log('‚úÖ Firebase Auth exitoso');
                console.log('üë§ UID:', userCredential.user.uid);
                
                // Obtener token
                const idToken = await userCredential.user.getIdToken();
                console.log('üé´ Token obtenido (primeros 50 chars):', idToken.substring(0, 50) + '...');
                
                // Probar endpoint del backend
                console.log('üåê Probando endpoint del backend...');
                const response = await fetch('http://localhost:8080/UMu5w9GVctvC4diaewkJ/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ idToken })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('‚úÖ Backend response:', data);
                    document.getElementById('result').innerHTML = '<p style="color: green;">‚úÖ Login exitoso!</p>';
                } else {
                    const errorText = await response.text();
                    console.error('‚ùå Backend error:', response.status, errorText);
                    document.getElementById('result').innerHTML = `<p style="color: red;">‚ùå Error ${response.status}: ${errorText}</p>`;
                }
                
            } catch (error) {
                console.error('‚ùå Error:', error);
                document.getElementById('result').innerHTML = `<p style="color: red;">‚ùå Error: ${error.message}</p>`;
            }
        };
    </script>
</head>
<body>
    <h1>Debug Login</h1>
    <p>Esta p√°gina te ayudar√° a probar el login y ver exactamente qu√© est√° pasando.</p>
    
    <button onclick="testLogin()" style="padding: 10px 20px; font-size: 16px;">
        üîç Probar Login
    </button>
    
    <div id="result" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>
    
    <div style="margin-top: 20px;">
        <h3>Instrucciones:</h3>
        <ol>
            <li>Abre las herramientas de desarrollador (F12)</li>
            <li>Ve a la pesta√±a Console</li>
            <li>Haz clic en "Probar Login"</li>
            <li>Revisa los logs en la consola</li>
        </ol>
    </div>
</body>
</html>
